{% extends 'store/base.html' %}
{% load static %}

{% block content %}
<div class="container py-5 mt-5 text-center">
    <div class="row justify-content-center fade-up">
        <div class="col-md-6 col-lg-5">
            
            <div class="p-4 rounded-4" style="background: #111; border: 1px solid #333; box-shadow: 0 0 30px rgba(212, 175, 55, 0.1);">
                
                <h3 class="text-white mb-2" style="font-family: 'Playfair Display', serif;">Оплата заказа</h3>
                <div class="badge bg-warning text-dark fs-6 mb-4">#{{ order.id }}</div>

                <p class="text-white-50 mb-4">
                    К оплате: <b class="text-white fs-3">{{ order.total }} c.</b>
                </p>

                <div class="mb-4">
                    <div class="bg-white p-2 rounded-3 d-inline-block position-relative">
                        <img src="{% static 'img/qr.jpg' %}" alt="Business QR" class="img-fluid" style="width: 180px; height: 180px;">
                    </div>
                    <p class="text-white-50 small mt-2">Сканируйте через приложение банка</p>
                </div>

                <div class="d-flex align-items-center justify-content-center mb-4">
                    <hr class="flex-grow-1 border-secondary">
                    <span class="mx-3 text-white-50 small">ИЛИ ПЕРЕВОД ПО РЕКВИЗИТАМ</span>
                    <hr class="flex-grow-1 border-secondary">
                </div>

                <p class="text-white mb-1 fw-bold">ИП Ажимаматова А.</p>
                <label class="text-start w-100 text-white-50 small mb-2">Расчетный счет:</label>
                <div class="input-group mb-4">
                    <input type="text" class="form-control bg-dark text-white border-secondary fw-bold text-center fs-6" 
                           value="1250820013421354" id="phoneInput" readonly style="height: 50px;">
                    
                    <button class="btn btn-outline-warning" type="button" onclick="copyPhone()" style="width: 60px;">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>

                <div class="alert alert-dark border-warning text-start mb-4" role="alert">
                    <div class="d-flex">
                        <i class="fas fa-exclamation-circle text-warning fs-4 me-3 mt-1"></i>
                        <div>
                            <strong class="text-white">ОБЯЗАТЕЛЬНО!</strong><br>
                            <span class="text-white-50 small">В назначении платежа/комментарии укажите цифру:</span>
                            <div class="text-warning fw-bold fs-4 mt-1">{{ order.id }}</div>
                        </div>
                    </div>
                </div>

                <a href="{{ whatsapp_url }}" class="btn btn-luxury w-100 py-3 fw-bold shadow-lg text-uppercase">
                    <i class="fas fa-check-circle me-2"></i> Я оплатил(а)
                </a>
                
                <div class="mt-4 text-white-50 small" style="font-size: 0.75rem;">
                    <i class="fas fa-clock me-1 text-warning"></i> 
                    Оператор проверит поступление средств в течение 5 минут.
                </div>
                
                <div class="mt-3">
                    <a href="{% url 'home' %}" class="text-muted small text-decoration-none border-bottom border-secondary">Вернуться назад</a>
                </div>
            </div>

        </div>
    </div>
</div>

<script>
    function copyPhone() {
        var copyText = document.getElementById("phoneInput");
        copyText.select();
        copyText.setSelectionRange(0, 99999); // Для мобильных
        
        navigator.clipboard.writeText(copyText.value).then(() => {
            // Анимация кнопки при успехе
            var btn = document.querySelector('.btn-outline-warning');
            btn.innerHTML = '<i class="fas fa-check"></i>';
            btn.classList.remove('btn-outline-warning');
            btn.classList.add('btn-success');
            
            setTimeout(function() {
                btn.innerHTML = '<i class="fas fa-copy"></i>';
                btn.classList.add('btn-outline-warning');
                btn.classList.remove('btn-success');
            }, 2000);
        });
    }
</script>

<style>
    /* Делаем поле счета красивым */
    #phoneInput:focus {
        box-shadow: none;
        border-color: var(--gold);
    }
</style>
{% endblock %}